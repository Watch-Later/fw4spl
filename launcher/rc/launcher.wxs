<?xml version="1.0" encoding="utf-8"?>

<Wix xmlns="http://schemas.microsoft.com/wix/2003/01/wi">

  <Module Id="launcher" Guid="12345678-8DEE-4410-990A-1802896C4258" Language="0" Version="1.2.3">

    <Package Id="12345678-8DEE-4410-990A-1802896C4258" InstallerVersion="200"
      Languages="1033" Manufacturer="Acme" SummaryCodepage="1252" AdminImage="no" ShortNames="no" />

	<Icon Id="icn_laun" src="../../CommonLib/bin/launcher_0-1_win32_cl7-1.exe" />
	
    <Directory Id='TARGETDIR' Name='SourceDir'>
      <Directory Id='ProgramFilesFolder' Name='PFiles'>
        <Directory Id='IRCAD' Name='IRCAD'>
          <Directory Id='INSTALLDIR' Name='$(var.SOFTWARE)' LongName='$(var.SOFTWARE) $(var.VERSION)'>
			  <Directory Id="ProgramMenuFolder" Name="PMenu" LongName="Programs">
				<Directory Id="IRCADFolder" Name="IRCAD">
					<Directory Id="ProgramMenuDir" Name='$(var.SOFTWARE)' LongName="$(var.SOFTWARE) $(var.VERSION)" />
				</Directory>
			  </Directory>
			  <Directory Id="DesktopFolder" Name="Desktop" />
			  
			<Component Id='MainExecutable' Guid='11112222-83F1-4F22-985B-FDB3C8ABD471'>
			
			  <File Id='$(var.SOFTWARE)EXE' Name='$(var.SOFTWARE).exe' LongName='$(var.SOFTWARE)_$(var.VERSION).exe'
				Source='../../CommonLib/bin/launcher_0-1_win32_cl7-1.exe' Vital='yes'>
			  <Shortcut Id="startmenuMyVFPApp" Directory="ProgramMenuDir" Name="$(var.SOFTWARE)"
			  LongName="$(var.SOFTWARE) $(var.VERSION)" WorkingDirectory='INSTALLDIR' Icon="icn_laun" IconIndex="0" />
			  <Shortcut Id="desktopMyVFPApp" Directory="DesktopFolder" Name="$(var.SOFTWARE)" 
			  LongName="$(var.SOFTWARE) $(var.VERSION)" WorkingDirectory='INSTALLDIR' Icon="icn_laun" IconIndex="0" />
			  </File>
			  
			  <File Id='$(var.SOFTWARE)PDF' Name='doc.pdf' LongName='$(var.SOFTWARE)_$(var.VERSION).pdf'
				Source='../../Config/wix/$(var.SOFTWARE)/$(var.SOFTWARE)_$(var.VERSION)_User_Manual_Eng.pdf' Vital='yes'>
			  <Shortcut Id="startmenuDoc" Directory="ProgramMenuDir" Name="doc.pdf"
			  LongName="$(var.SOFTWARE) $(var.VERSION) Documentation.pdf" WorkingDirectory='INSTALLDIR' Icon="icn_laun" IconIndex="0" />
			  </File>
			  
			  <File Id='$(var.SOFTWARE)QPDF' Name='qstart.pdf' LongName='$(var.SOFTWARE)_$(var.VERSION)_QuickStart.pdf'
				Source='../../Config/wix/$(var.SOFTWARE)/$(var.SOFTWARE)_$(var.VERSION)_Quickstart.pdf' Vital='yes'>
			  <Shortcut Id="startmenuQStart" Directory="ProgramMenuDir" Name="qstart.pdf"
			  LongName="$(var.SOFTWARE) $(var.VERSION) QuickStart.pdf" WorkingDirectory='INSTALLDIR' Icon="icn_laun" IconIndex="0" />
			  </File>
			  
			  <File Id="ircad.txt" Name="ircad.url" LongName="ircad.url" Vital="yes" Source="ircad.txt">
				<Shortcut Id="startmenuInternetIRCAD" Directory="ProgramMenuDir" Advertise="yes" Name="Intern" LongName="IRCAD WebSite" 
				WorkingDirectory="INSTALLDIR" Icon="icn_IRCAD">
					<Icon Id="icn_IRCAD" src="../../CommonLib/bin/launcher_0-1_win32_cl7-1.exe" />
			    </Shortcut>
			  </File>
			  <File Id="websurg.txt" Name="websurg.url" LongName="websurg.url" Vital="yes" Source="websurg.txt">
				<Shortcut Id="startmenuInternetWEBSURG" Directory="ProgramMenuDir" Advertise="yes" Name="Intern" LongName="WebSurg WebSite" 
				WorkingDirectory="INSTALLDIR" Icon="icn_WEBSURG">
					<Icon Id="icn_WEBSURG" src="../../CommonLib/bin/launcher_0-1_win32_cl7-1.exe" />
			    </Shortcut>
			  </File>
			  
			  <RemoveFolder Id='ProgramMenuDir' On='uninstall' />
            </Component>

			<Component Id='profile' Guid='11112222-83F1-4F22-985B-FDB3C8ABD500'>
				<File Id="pXML"	Name="profile.xml" LongName="profile.xml" Source="../../CommonLib/share/launcher_0-1/$(var.SOFTWARE).xml" />
			</Component>
			
			<Directory Id='shareDIR' Name='share'>
				<Directory Id='LAUNCHERDIR' Name='launcher' LongName='launcher_0-1'>
					<Directory Id='LOCALEDIR' Name='locale' >
						<Directory Id='FRDIR' Name='fr' >
							<Directory Id='LCDIR' Name='LC' LongName='LC_MESSAGES'>
								<Component Id='i18n' Guid='11112222-83F1-4F22-985B-FDB3C8ABD501'>
									<File Id="launcherMO" Name="launcher.mo" Source="../../CommonLib/share/launcher_0-1/locale/fr/LC_MESSAGES/launcher.mo" />
									<File Id="runtimeMO" Name="runtime.mo" Source="../../CommonLib/share/launcher_0-1/locale/fr/LC_MESSAGES/runtime.mo" />
									<File Id="$(var.SOFTWARE)MO" Name="$(var.SOFTWARE).mo" Source="../../CommonLib/share/launcher_0-1/locale/fr/LC_MESSAGES/$(var.SOFTWARE).mo" />
								</Component>
							</Directory>
						</Directory>
					</Directory>
				</Directory>
			</Directory>
		  </Directory>
		</Directory>
	  </Directory>
	</Directory>
  </Module>
</Wix>
